<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Trading Days This Quarter – Quarter Counter</title>
<link rel="canonical" href="https://tradingdaysthisquarter.com/" />
<meta name="description" content="Live trading days remaining this quarter. Accurate by exchange (NYSE free; Pro unlocks LSE & more). Include-today toggle, world clocks, and notes." />
<meta property="og:title" content="Trading Days This Quarter" />
<meta property="og:description" content="Live trading-day countdown by exchange. NYSE free; more markets in Pro." />
<meta property="og:url" content="https://tradingdaysthisquarter.com/" />
<meta property="og:type" content="website" />
<style>
  :root{
    --bg:#0b0c0f; --card:#121419; --muted:#2a2f3a; --text:#e9eef7; --sub:#9ba7bd; --ok:#5dd39e;
    --metaSize:34px; --titleSize:34px;
  }
  body.light{
    --bg:#fafbfd; --card:#ffffff; --muted:#e7ecf5; --text:#0b0c0f; --sub:#536079; --ok:#1f8f55;
  }

  *{box-sizing:border-box}
  body{margin:0;font:16px/1.45 Inter,system-ui,Segoe UI,Arial;background:var(--bg);color:var(--text)}
  .wrap{max-width:1120px;margin:40px auto;padding:0 20px}
  .topbar{display:flex;justify-content:space-between;align-items:center;gap:10px}
  .themeBtn,.btn{border:1px solid #1a1f2b;background:transparent;color:var(--text);padding:6px 12px;border-radius:10px;cursor:pointer;text-decoration:none}
  body.light .themeBtn, body.light .btn{border-color:#cfd6e6;color:#0b0c0f}
  .actions{display:flex;gap:10px; align-items:center}

  /* Header */
  .center{display:flex;flex-direction:column;align-items:center;gap:6px;margin-bottom:18px;text-align:center}
  .brandRow{display:flex;align-items:center;gap:6px}
  .logo{width:46px;height:46px}
  .title{font-weight:900;letter-spacing:.2px;font-size:var(--titleSize)}

  .card{background:linear-gradient(180deg,var(--card),rgba(0,0,0,0.02));border:1px solid #1a1f2b;border-radius:14px;padding:22px}
  body.light .card{border-color:#d7deee}

  /* Market selector */
  .market{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
  .select{appearance:none;background:#0c0f15;border:1px solid #1b2130;border-radius:10px;color:var(--text);padding:8px 12px;cursor:pointer}
  body.light .select{background:#eef2fb;border-color:#cfd6e6;color:#0b0c0f}
  .proTag{font-size:12px;color:#ef9aa8;border:1px solid #6b1f28;padding:2px 6px;border-radius:6px}
  .packs{font-size:12px;color:#9fb0ce}

  /* Quarter area */
  .qHeader{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:8px;flex-wrap:wrap}
  .qMain{display:flex;flex-direction:column;align-items:center;gap:12px;margin:8px 0 6px}
  .qLabel{font-size:44px;font-weight:900;line-height:1;margin-bottom:10px}
  .qDaysLeft{font-size:66px;font-weight:900;letter-spacing:.5px;line-height:1}
  .qCaption{font-size:var(--metaSize);color:#cbd6ec;opacity:.95;line-height:1.15;margin-top:0}
  body.light .qCaption{color:#4b5568;opacity:1}

  /* Small controls row */
  .smallRow{display:flex;gap:14px;align-items:center;justify-content:center;margin-top:4px;color:#9fb0ce}
  .chk{display:flex;align-items:center;gap:8px;font-weight:700}

  /* Progress bar */
  .qbarWrap{width:100%;margin-top:12px}
  .qbar{position:relative;width:100%;height:62px;padding:6px;border-radius:14px;background:#0c0f15;border:1px solid #1b2130;overflow:hidden}
  body.light .qbar{background:#eaf0fb;border-color:#d4dbed}
  .bar{display:flex;gap:4px;height:100%}
  .seg{height:100%;flex:1;border-radius:8px;opacity:.96;transition:transform .35s ease;transform-origin:left}
  .seg.on{opacity:1}

  /* Toggle */
  .toggleWrap{display:flex;justify-content:center;margin-top:12px}
  .toggle{position:relative;display:flex;align-items:center;justify-content:space-between;background:#0c1118;border:1px solid #1b2130;border-radius:999px;padding:6px;width:520px;max-width:100%}
  body.light .toggle{background:#eaf0fb;border-color:#cfd6e6}
  .toggle .knob{position:absolute;z-index:1;top:4px;bottom:4px;width:50%;border-radius:999px;background:#1a2434;transition:transform .25s ease}
  body.light .toggle .knob{background:#d7def1}
  .toggle.remain .knob{transform:translateX(0)}
  .toggle.spent .knob{transform:translateX(100%)}
  .toggle button{position:relative;z-index:2;border:none;background:transparent;color:#c6d2ea;font-weight:800;font-size:var(--metaSize);padding:6px 18px;border-radius:999px;cursor:pointer;flex:1;text-align:center}
  body.light .toggle button{color:#33415f}

  .metaLarge{font-size:var(--metaSize);font-weight:800;color:#cbd6ec;opacity:.95;letter-spacing:.2px}
  body.light .metaLarge{color:#3e4a61;opacity:1}

  /* Grid */
  .grid{display:grid;gap:16px}
  .grid-2{grid-template-columns:1fr}
  .grid-3{grid-template-columns:repeat(3,1fr)}
  @media(min-width:920px){ .grid-2{grid-template-columns:1.15fr .85fr} }

  /* Year list */
  .yearList{display:grid;grid-template-columns:repeat(5,1fr);gap:10px;margin-top:10px}
  .yearCard{padding:14px;border:1px solid #1b2130;border-radius:12px;background:#0c0f15}
  body.light .yearCard{background:#f6f8fe;border-color:#d4dbed}
  .yearHead{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
  .yTitle{font-weight:800}
  .yNum{font-weight:900;font-size:22px}

  /* World clocks */
  .clocks{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:10px}
  .clock{padding:14px;border:1px solid #1b2130;border-radius:12px;background:#0c0f15;text-align:center}
  body.light .clock{background:#f6f8fe;border-color:#d4dbed}
  .cCity{font-weight:700;margin-bottom:4px}
  .cTime{font-size:22px;font-weight:900}

  /* Pricing strip */
  .pricing{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:18px}
  .plan{padding:18px;border:1px solid #1b2130;border-radius:12px;background:#0c0f15}
  body.light .plan{background:#f6f8fe;border-color:#d4dbed}
  .plan h3{margin:0 0 6px 0}
  .big{font-size:28px;font-weight:900}
  .list{margin:8px 0 0 0;padding-left:18px;color:#c6d2ea}
  .cta{margin-top:10px;display:inline-block}

  textarea.ta{width:100%;height:120px;background:#0c0f15;border:1px solid #1b2130;border-radius:10px;color:var(--text);padding:10px;resize:vertical}
  body.light textarea.ta{background:#f6f8fe;border-color:#d4dbed;color:#0b0c0f}
</style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="market">
        <label for="marketSel" class="subtitle">Market:</label>
        <select id="marketSel" class="select">
          <optgroup label="US Pack">
            <option value="NYSE" selected>NYSE — Free</option>
          </optgroup>
          <optgroup label="UK Pack (Pro)">
            <option value="LSE">LSE — Pro</option>
          </optgroup>
        </select>
        <span class="packs">(More regions in Pro)</span>
        <span class="proTag" id="proTag" style="display:none">Pro Active</span>
      </div>
      <div class="actions">
        <a class="btn" id="updatesBtn" href="#" target="_blank" rel="noopener">Get Updates</a>
        <a class="btn" id="preorderBtn" href="#" target="_blank" rel="noopener">Join Pro Waitlist</a>
        <a class="btn" id="unlockBtn" href="#" onclick="openUnlock();return false;">Unlock Pro</a>
        <button id="themeBtn" class="themeBtn" aria-pressed="false">☀️ Light</button>
      </div>
    </div>

    <!-- Header -->
    <div class="center">
      <div class="brandRow">
        <svg class="logo" viewBox="0 0 64 64" aria-hidden="true">
          <defs>
            <linearGradient id="g1" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%" stop-color="#79b6ff"/><stop offset="100%" stop-color="#3b82f6"/>
            </linearGradient>
            <linearGradient id="g2" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%" stop-color="#9f8bff"/><stop offset="100%" stop-color="#6d5df5"/>
            </linearGradient>
            <linearGradient id="g3" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%" stop-color="#ff7284"/><stop offset="100%" stop-color="#ef4444"/>
            </linearGradient>
            <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
              <feDropShadow dx="0" dy="0" stdDeviation="1.4" flood-color="#3b82f6" flood-opacity=".35"/>
            </filter>
          </defs>
          <circle cx="32" cy="32" r="30" fill="transparent" stroke="currentColor" stroke-width="1.5" opacity=".22"/>
          <g transform="skewX(-12) translate(-2,0)" filter="url(#glow)">
            <rect x="16" y="34" width="9" height="15" rx="2.5" fill="url(#g1)"/>
            <rect x="28" y="26" width="9" height="23" rx="2.5" fill="url(#g2)"/>
            <rect x="40" y="16" width="9" height="33" rx="2.5" fill="url(#g3)"/>
          </g>
        </svg>
        <div class="title">Quarter Counter</div>
      </div>
    </div>

    <!-- Quarter block -->
    <div class="card">
      <div class="qHeader">
        <div id="marketLabel" class="subtitle">NYSE • America/New_York</div>
        <div class="tip"><span class="dot"></span>How we count
          <div class="bubble">Mon–Fri only • Excludes exchange holidays • No half-days</div>
        </div>
      </div>

      <div class="qMain">
        <div id="qLabel" class="qLabel">Q4 2025</div>

        <!-- BIG number + caption -->
        <div id="qDaysLeft" class="qDaysLeft">—</div>
        <div id="qCaption" class="qCaption">Trading Days Remaining</div>

        <div class="smallRow">
          <label class="chk"><input type="checkbox" id="incToday"> Include Today (if open)</label>
        </div>

        <!-- Progress bar -->
        <div class="qbarWrap">
          <div class="qbar" title="Quarter progress (trading days)">
            <div id="qbarBase" class="bar"></div>
            <div id="qbarFillMask" style="position:absolute;left:6px;top:6px;bottom:6px;width:0;overflow:hidden;border-radius:10px;">
              <div id="qbarFill" class="bar"></div>
            </div>
          </div>
        </div>

        <!-- Toggle -->
        <div class="toggleWrap">
          <div id="pctToggle" class="toggle remain" role="tablist" aria-label="Remaining vs Spent">
            <div class="knob" aria-hidden="true"></div>
            <button id="btnRemain" role="tab" aria-selected="true">Remaining</button>
            <button id="btnSpent" role="tab" aria-selected="false">Spent</button>
          </div>
        </div>

        <div class="metaLarge" style="margin-top:8px">
          <span id="qSub">Day — of —</span> • <span id="pctText">—%</span>
        </div>
      </div>
    </div>

    <!-- Year totals + World clocks -->
    <div class="grid grid-2" style="margin-top:16px">
      <div class="card">
        <strong>Yearly Trading Days (est.)</strong>
        <div class="yearList" id="yearList"></div>
        <div class="subtitle" style="margin-top:6px">Current year uses selected market holidays; future years are Mon–Fri estimates.</div>
      </div>

      <div class="card">
        <strong>World Clocks</strong>
        <div class="clocks">
          <div class="clock"><div class="cCity">London</div><div class="cTime" id="tLDN">--:--</div></div>
          <div class="clock"><div class="cCity">New York</div><div class="cTime" id="tNYC">--:--</div></div>
          <div class="clock"><div class="cCity">Tokyo</div><div class="cTime" id="tTYO">--:--</div></div>
          <div class="clock"><div class="cCity">Shanghai</div><div class="cTime" id="tSHA">--:--</div></div>
        </div>
      </div>
    </div>

    <!-- Pricing strip -->
    <div class="pricing">
      <div class="plan">
        <h3>Free</h3>
        <div class="big">£0</div>
        <ul class="list">
          <li>NYSE (US) market</li>
          <li>Trading Days Remaining bar</li>
          <li>World clocks</li>
          <li>Notes (saved locally)</li>
        </ul>
        <a class="btn cta" id="ctaFree" href="#app">Start Free</a>
      </div>
      <div class="plan">
        <h3>Pro</h3>
        <div class="big">Early-bird</div>
        <ul class="list">
          <li>LSE (UK) + more regions</li>
          <li>Daily snapshot & reminders</li>
          <li>CSV export</li>
          <li>Custom clocks & holidays</li>
        </ul>
        <a class="btn cta" id="ctaPro" href="#" onclick="openUnlock();return false;">Unlock Pro</a>
      </div>
    </div>

    <!-- Notes -->
    <div class="grid grid-3" style="margin-top:16px">
      <div class="card">
        <strong>Hard Targets</strong>
        <textarea id="hard" class="ta" placeholder="e.g. Achieve 4 A+ setups this quarter"></textarea>
      </div>
      <div class="card">
        <strong>Soft Targets</strong>
        <textarea id="soft" class="ta" placeholder="e.g. Journal every Friday; follow entry checklist"></textarea>
      </div>
      <div class="card">
        <strong>Set-ups & Timing Notes</strong>
        <textarea id="setups" class="ta" placeholder="e.g. When TSLA tests VWAP on rising volume → wait 15m retest"></textarea>
      </div>
    </div>
  </div>

<!-- Unlock modal -->
<div id="unlockModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.6); z-index:9999; align-items:center; justify-content:center;">
  <div style="background:var(--card); border:1px solid #1a1f2b; border-radius:12px; padding:18px; width:90%; max-width:420px;">
    <h3 style="margin:0 0 8px 0;">Enter Pro License</h3>
    <p class="subtitle" style="margin:0 0 12px 0;">Paste the code we emailed you after purchase.</p>
    <input id="licenseInput" type="text" placeholder="e.g. QTA-ALPHA-2025"
      style="width:100%; padding:10px; border-radius:8px; border:1px solid #1b2130; background:#0c0f15; color:var(--text); margin-bottom:12px;">
    <div style="display:flex; gap:8px; justify-content:flex-end;">
      <button class="btn" onclick="closeUnlock()">Cancel</button>
      <button class="btn" onclick="verifyLicense()">Unlock</button>
    </div>
    <div id="licenseMsg" class="subtitle" style="margin-top:8px;"></div>
  </div>
</div>

<!-- Email capture modal -->
<div id="emailModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.6); z-index:9999; align-items:center; justify-content:center;">
  <div style="background:var(--card); border:1px solid #1a1f2b; border-radius:12px; padding:18px; width:90%; max-width:420px;">
    <h3 style="margin:0 0 8px 0;">Get Updates</h3>
    <p class="subtitle" style="margin:0 0 12px 0;">Leave your email and we’ll notify you when Pro launches.</p>
    <form id="emailForm" onsubmit="submitEmail(event)">
      <input id="emailInput" type="email" required placeholder="you@example.com"
        style="width:100%; padding:10px; border-radius:8px; border:1px solid #1b2130; background:#0c0f15; color:var(--text); margin-bottom:12px;">
      <div style="display:flex; gap:8px; justify-content:flex-end;">
        <button class="btn" type="button" onclick="closeEmail()">Cancel</button>
        <button class="btn" type="submit">Notify Me</button>
      </div>
    </form>
    <div id="emailMsg" class="subtitle" style="margin-top:8px;"></div>
  </div>
</div>

<script>
/* ===== Markets ===== */
const MARKETS = {
  NYSE: {
    code:'NYSE', tz:'America/New_York', open:'09:30', close:'16:00',
    holidays: ['2025-01-01','2025-01-20','2025-02-17','2025-04-18','2025-05-26','2025-06-19','2025-07-04','2025-09-01','2025-11-27','2025-12-25']
  },
  LSE: {
    code:'LSE', tz:'Europe/London', open:'08:00', close:'16:30',
    holidays: ['2025-01-01','2025-04-18','2025-04-21','2025-05-05','2025-05-26','2025-08-25','2025-12-25','2025-12-26']
  }
};
let CURRENT = MARKETS.NYSE;

/* ===== Pro gate ===== */
const PRO_FLAG = 'qta_pro_unlocked';
function openUnlock(){ document.getElementById('unlockModal').style.display='flex'; }
function closeUnlock(){ document.getElementById('unlockModal').style.display='none'; }
async function sha256(text){ const enc=new TextEncoder().encode(text); const buf=await crypto.subtle.digest('SHA-256',enc); return [...new Uint8Array(buf)].map(b=>b.toString(16).padStart(2,'0')).join(''); }
const VALID_SHA256 = []; // add hashes later
async function verifyLicense(){
  const input = document.getElementById('licenseInput').value.trim();
  const msg = document.getElementById('licenseMsg');
  if(!input){ msg.textContent='Please enter your code.'; return; }
  const hash = await sha256(input);
  if(VALID_SHA256.includes(hash)){
    localStorage.setItem(PRO_FLAG,'1');
    msg.textContent='✅ Pro unlocked on this device.';
    setTimeout(()=>{ closeUnlock(); renderProState(); render(); }, 600);
  } else {
    msg.textContent='❌ That code was not recognized.';
  }
}
function isPro(){ return localStorage.getItem(PRO_FLAG) === '1'; }
function renderProState(){
  const unlock=document.getElementById('unlockBtn');
  const pre=document.getElementById('preorderBtn');
  if(isPro()){
    document.getElementById('proTag').style.display='inline-block';
    unlock.textContent='Pro Active'; unlock.style.pointerEvents='none';
    pre.style.display='none';
  } else {
    document.getElementById('proTag').style.display='none';
    unlock.textContent='Unlock Pro'; unlock.style.pointerEvents='auto';
    pre.style.display='inline-flex';
  }
}

/* ===== Helpers ===== */
const pad=n=>String(n).padStart(2,'0');
const toLocal=(d,tz)=> new Date(d.toLocaleString('en-GB',{timeZone:tz}));
function isHoliday(d,m){ const y=d.getFullYear(), mm=pad(d.getMonth()+1), dd=pad(d.getDate()); return m.holidays.includes(`${y}-${mm}-${dd}`); }
function isTradingDay(d,m){
  const loc=toLocal(d, m.tz);
  const w=loc.getDay();
  return !(w===0 || w===6 || isHoliday(loc,m));
}
function quarterBounds(d){
  const y=d.getFullYear(), m=d.getMonth();
  const q = Math.floor(m/3)+1;
  const startMonth = (q-1)*3;
  const start = new Date(Date.UTC(y,startMonth,1));
  const endMonth = startMonth+3;
  const end = new Date(Date.UTC(y,endMonth,0));
  return {q, start, end};
}
function countTradingDaysInclusive(start, end, m){
  let n=0, d=new Date(start);
  while(d<=end){ if(isTradingDay(d,m)) n++; d.setUTCDate(d.getUTCDate()+1); }
  return n;
}
function tradingDaysGoneInQuarter(today, start, m, includeToday){
  let n=0, d=new Date(start);
  while(d<=today){ if(isTradingDay(d,m)) n++; d.setUTCDate(d.getUTCDate()+1); }
  // if not including today and today was a trading day, subtract 1
  if(!includeToday){
    const wasTrading=isTradingDay(today,m);
    if(wasTrading) n = Math.max(0, n-1);
  }
  return Math.max(0, n);
}
function yearTotalFor(m, year, useHolidays){
  const start=new Date(Date.UTC(year,0,1));
  const end=new Date(Date.UTC(year,11,31));
  let n=0, d=new Date(start);
  while(d<=end){
    const w=d.getUTCDay();
    if(w>=1 && w<=5){
      if(useHolidays){
        const loc=new Date(d.toLocaleString('en-GB',{timeZone:m.tz}));
        const iso=`${loc.getFullYear()}-${pad(loc.getMonth()+1)}-${pad(loc.getDate())}`;
        if(!m.holidays.includes(iso)) n++;
      } else n++;
    }
    d.setUTCDate(d.getUTCDate()+1);
  }
  return n;
}
function hueAt(t){ const h=220 + (10-220)*t, s=96 + (85-96)*t, l=52 + (40-52)*t; return `hsl(${h}deg ${s}% ${l}%)`; }

/* ===== Rendering ===== */
let showRemaining = true;

function render(){
  const includeToday = document.getElementById('incToday').checked;
  const now=new Date();
  const {q,start,end}=quarterBounds(now);
  const total=countTradingDaysInclusive(start,end,CURRENT);
  const gone=tradingDaysGoneInQuarter(now,start,CURRENT, includeToday);
  const remaining=Math.max(0,total-gone);
  const pctRem = Math.round(100*remaining/total);
  const pctSpent = 100-pctRem;

  document.getElementById('marketLabel').textContent = `${CURRENT.code} • ${CURRENT.tz}`;
  document.getElementById('qLabel').textContent = `Q${q} ${now.getFullYear()}`;
  document.getElementById('qDaysLeft').textContent = `${remaining}`;
  document.getElementById('qCaption').textContent = 'Trading Days Remaining';

  // base
  const base=document.getElementById('qbarBase'); base.innerHTML='';
  for(let i=0;i<total;i++){
    const seg=document.createElement('div');
    seg.className='seg';
    seg.style.background=hueAt((i+1)/total);
    base.appendChild(seg);
  }
  // fill
  const fill=document.getElementById('qbarFill'); fill.innerHTML='';
  for(let i=0;i<gone;i++){
    const seg=document.createElement('div');
    seg.className='seg on';
    seg.style.background=hueAt((i+1)/total);
    fill.appendChild(seg);
  }
  const mask = document.getElementById('qbarFillMask');
  mask.style.width = '0';
  requestAnimationFrame(()=>{
    const pct = (gone/total)*100;
    mask.style.transition = 'width 700ms ease';
    mask.style.width = pct + '%';
  });

  // Toggle text
  const pctEl = document.getElementById('pctText');
  pctEl.textContent = showRemaining ? `${pctRem}%` : `${pctSpent}%`;

  // Meta
  document.getElementById('qSub').textContent = `Day ${Math.min(gone,total)} of ${total}`;

  // Year list (current + next 4)
  const yCont = document.getElementById('yearList'); yCont.innerHTML='';
  const currentYear = now.getFullYear();
  const years = [currentYear, currentYear+1, currentYear+2, currentYear+3, currentYear+4];
  years.forEach(y=>{
    const totalY = yearTotalFor(CURRENT, y, y===currentYear);
    const card = document.createElement('div');
    card.className='yearCard';
    card.innerHTML = `<div class="yearHead"><div class="yTitle">Year ${y}</div><div class="yNum">${totalY}</div></div><div class="subtitle">Total trading days</div>`;
    yCont.appendChild(card);
  });
}

function tick(){
  // world clocks
  const fmt = (tz)=> new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit', hour12:false, timeZone: tz});
  document.getElementById('tLDN').textContent = fmt('Europe/London');
  document.getElementById('tNYC').textContent = fmt('America/New_York');
  document.getElementById('tTYO').textContent = fmt('Asia/Tokyo');
  document.getElementById('tSHA').textContent = fmt('Asia/Shanghai');
}

/* Market selector gating */
document.getElementById('marketSel').addEventListener('change', (e)=>{
  const v = e.target.value;
  if(v==='NYSE'){ CURRENT = MARKETS.NYSE; render(); return; }
  if(v==='LSE'){
    if(isPro()){ CURRENT = MARKETS.LSE; render(); }
    else { openUnlock(); e.target.value='NYSE'; }
  }
});

/* Toggle behavior */
const toggle = document.getElementById('pctToggle');
document.getElementById('btnRemain').addEventListener('click', () => {
  showRemaining = true;
  toggle.classList.remove('spent'); toggle.classList.add('remain');
  render();
});
document.getElementById('btnSpent').addEventListener('click', () => {
  showRemaining = false;
  toggle.classList.remove('remain'); toggle.classList.add('spent');
  render();
});
document.getElementById('incToday').addEventListener('change', render);

/* notes persistence */
['hard','soft','setups'].forEach(id=>{
  const el=document.getElementById(id);
  el.value = localStorage.getItem('qta_'+id) || '';
  el.addEventListener('input', ()=>{
    clearTimeout(el._t);
    el._t=setTimeout(()=>localStorage.setItem('qta_'+id, el.value), 250);
  });
});

/* theme toggle */
const themeBtn = document.getElementById('themeBtn');
const prefersLight = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;
if(prefersLight){ document.body.classList.add('light'); themeBtn.textContent='🌙 Dark'; themeBtn.setAttribute('aria-pressed','true'); }
themeBtn.addEventListener('click', ()=>{
  document.body.classList.toggle('light');
  const light = document.body.classList.contains('light');
  themeBtn.textContent = light ? '🌙 Dark' : '☀️ Light';
  themeBtn.setAttribute('aria-pressed', light ? 'true' : 'false');
});

/* Email modal */
function openEmail(){ document.getElementById('emailModal').style.display='flex'; }
function closeEmail(){ document.getElementById('emailModal').style.display='none'; }
document.getElementById('updatesBtn').addEventListener('click', (e)=>{ e.preventDefault(); openEmail(); });
function submitEmail(e){
  e.preventDefault();
  const email = document.getElementById('emailInput').value.trim();
  const msg = document.getElementById('emailMsg');
  if(!email){ msg.textContent='Please enter an email.'; return; }
  // Simple fallback: opens mail client; replace later with your email provider form action
  window.location.href = `mailto:founder@tradingdaysthisquarter.com?subject=Pro%20Updates&body=Please%20add%20${encodeURIComponent(email)}%20to%20the%20Pro%20waitlist.`;
  msg.textContent='Thanks! Your mail app should open — we’ll add you.';
}

/* init */
renderProState();
render(); tick(); setInterval(tick,1000);

/* links placeholders */
document.getElementById('preorderBtn').href = "mailto:founder@tradingdaysthisquarter.com?subject=Join%20Pro%20Waitlist&body=Hi%2C%20please%20add%20me%20to%20the%20Pro%20waitlist.%20Name%3A%20%0AMarkets%20of%20interest%3A%20";
</script>
</body>
</html>
